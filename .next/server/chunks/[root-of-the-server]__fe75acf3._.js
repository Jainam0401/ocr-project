module.exports=[24868,(e,t,r)=>{t.exports=e.x("fs/promises",()=>require("fs/promises"))},33405,(e,t,r)=>{t.exports=e.x("child_process",()=>require("child_process"))},66680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},45644,(e,t,r)=>{let a=e.r(33405).exec,n=console.debug;t.exports={recognize:function(e,t={}){var r;let o,i=(o=["tessdata-dir","user-words","user-patterns","psm","oem","dpi"],Object.entries(r=t).map(([e,t])=>{if(!["debug","presets","binary"].includes(e))return"lang"===e?`-l ${t}`:o.includes(e)?`--${e} ${t}`:`-c ${e}=${t}`}).concat(r.presets).filter(Boolean)),s=t.binary||"tesseract",l="string"!=typeof e||e.match(/^https?:\/\//)?"stdin":`"${e}"`,u=[s,l,"stdout",...i].join(" ");return t.debug&&n("command",u),new Promise((r,o)=>{let i=a(u,(e,a,i)=>{t.debug&&n(i),e&&o(e),r(a)});"stdin"===l&&function(e,t){if("string"==typeof e)return e.match(/^(.*?):/)[1],(()=>{let e=Error("Cannot find module as expression is too dynamic");throw e.code="MODULE_NOT_FOUND",e})().get(e,e=>{e.pipe(t.stdin)});Array.isArray(e)&&(e=Buffer.from(e.join("\n"),"utf-8")),t.stdin.write(e),t.stdin.end()}(e,i)})}}},64792,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),o=e.i(61916),i=e.i(14444),s=e.i(37092),l=e.i(69741),u=e.i(16795),d=e.i(87718),c=e.i(95169),p=e.i(47587),h=e.i(66012),f=e.i(70101),g=e.i(26937),m=e.i(10372),R=e.i(93695);e.i(52474);var v=e.i(220),x=e.i(89171),w=e.i(24868),y=e.i(14747),E=e.i(33405),C=e.i(24361),P=e.i(66680);let b={randomUUID:P.randomUUID},$=new Uint8Array(256),A=$.length,N=[];for(let e=0;e<256;++e)N.push((e+256).toString(16).slice(1));let O=function(e,t,r){if(b.randomUUID&&!t&&!e)return b.randomUUID();var a=e,n=r;let o=(a=a||{}).random??a.rng?.()??(A>$.length-16&&((0,P.randomFillSync)($),A=0),$.slice(A,A+=16));if(o.length<16)throw Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){if((n=n||0)<0||n+16>t.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=o[e];return t}return function(e,t=0){return(N[e[t+0]]+N[e[t+1]]+N[e[t+2]]+N[e[t+3]]+"-"+N[e[t+4]]+N[e[t+5]]+"-"+N[e[t+6]]+N[e[t+7]]+"-"+N[e[t+8]]+N[e[t+9]]+"-"+N[e[t+10]]+N[e[t+11]]+N[e[t+12]]+N[e[t+13]]+N[e[t+14]]+N[e[t+15]]).toLowerCase()}(o)};var T=e.i(45644);class D{value;next;constructor(e){this.value=e}}class U{#e;#t;#r;constructor(){this.clear()}enqueue(e){let t=new D(e);this.#e?this.#t.next=t:this.#e=t,this.#t=t,this.#r++}dequeue(){let e=this.#e;if(e)return this.#e=this.#e.next,this.#r--,e.value}peek(){if(this.#e)return this.#e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}*drain(){for(;this.#e;)yield this.dequeue()}}function S(e){if(!((Number.isInteger(e)||e===1/0)&&e>0))throw TypeError("Expected `concurrency` to be a number from 1 and up")}let _=C.default.promisify(E.exec);async function q(t){let r=null,a=null,n=Date.now();try{var o;let i,s,l,u,d,c=await t.formData(),p=c.get("file"),h=c.get("language")||"eng";if(!p)return x.NextResponse.json({success:!1,error:"No file uploaded"},{status:400});if(!p.name.toLowerCase().endsWith(".pdf"))return x.NextResponse.json({success:!1,error:"Only PDF files are supported"},{status:400});let f=O();r=y.default.join(process.cwd(),"temp",f),await w.default.mkdir(r,{recursive:!0});let g=await p.arrayBuffer(),m=Buffer.from(g);a=y.default.join(r,`${f}.pdf`),await w.default.writeFile(a,m),console.log(`Uploaded: ${p.name} (${(m.length/1024).toFixed(2)} KB)`);let R=await e.A(8490),v=(await R.PDFDocument.load(m)).getPageCount();console.log(`Total pages: ${v}`),console.log("Converting PDF to images..."),await _(`pdftoppm "${a}" "${y.default.join(r,"page")}" -png -r 200`),console.log("Conversion done");let E={lang:h,oem:1,psm:3},C=(o=3,S(o),i=new U,s=0,l=()=>{s<o&&i.size>0&&(s++,i.dequeue()())},u=async(e,t,r)=>{let a=(async()=>e(...r))();t(a);try{await a}catch{}s--,l()},d=(e,...t)=>new Promise(r=>{new Promise(e=>{i.enqueue(e)}).then(u.bind(void 0,e,r,t)),s<o&&l()}),Object.defineProperties(d,{activeCount:{get:()=>s},pendingCount:{get:()=>i.size},clearQueue:{value(){i.clear()}},concurrency:{get:()=>o,set(e){S(e),o=e,queueMicrotask(()=>{for(;s<o&&i.size>0;)l()})}},map:{async value(e,t){return Promise.all(Array.from(e,(e,r)=>this(t,e,r)))}}}),d),P=[];for(let e=1;e<=v;e++){let t=y.default.join(r,`page-${e}.png`);P.push(C(async()=>{console.log(`Running OCR on page ${e}/${v}`);try{let r=await T.default.recognize(t,E);return`

--- Page ${e} ---
${r}`}catch(t){return console.error(`OCR failed on page ${e}: ${t.message}`),`

--- Page ${e} ---
[Error: ${t.message}]`}}))}let b=(await Promise.allSettled(P)).map((e,t)=>"fulfilled"===e.status?e.value:`--- Page ${t+1} --- [Error]`).join("\n"),$=((Date.now()-n)/1e3).toFixed(2);return console.log(`OCR completed in ${$}s`),r&&(async()=>{try{await w.default.rm(r,{recursive:!0,force:!0}),console.log(`Temporary folder deleted: ${r}`)}catch(e){console.error("Cleanup error:",e.message)}})(),x.NextResponse.json({success:!0,text:b.trim(),metadata:{fileName:p.name,fileSize:`${(m.length/1024).toFixed(2)} KB`,totalPages:v,language:h,processingTime:`${$}s`,concurrency:3,dpi:200}})}catch(e){return console.error("Error processing PDF:",e),x.NextResponse.json({success:!1,error:e.message||"Failed to process PDF"},{status:500})}finally{r&&await w.default.rm(r,{recursive:!0,force:!0}).catch(e=>console.error("Cleanup error:",e.message))}}async function j(){return x.NextResponse.json({status:"healthy",endpoint:"/api/extract-text",methods:["POST"],description:"PDF to text OCR extraction API"})}e.s(["GET",()=>j,"POST",()=>q,"dynamic",0,"force-dynamic","maxDuration",0,300,"runtime",0,"nodejs"],55882);var I=e.i(55882);let F=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/extract-text/route",pathname:"/api/extract-text",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/extract-text/route.ts",nextConfigOutput:"",userland:I}),{workAsyncStorage:M,workUnitAsyncStorage:H,serverHooks:k}=F;function z(){return(0,a.patchFetch)({workAsyncStorage:M,workUnitAsyncStorage:H})}async function B(e,t,a){F.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let x="/api/extract-text/route";x=x.replace(/\/index$/,"")||"/";let w=await F.prepare(e,t,{srcPage:x,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:y,params:E,nextConfig:C,parsedUrl:P,isDraftMode:b,prerenderManifest:$,routerServerContext:A,isOnDemandRevalidate:N,revalidateOnlyGenerated:O,resolvedPathname:T,clientReferenceManifest:D,serverActionsManifest:U}=w,S=(0,l.normalizeAppPath)(x),_=!!($.dynamicRoutes[S]||$.routes[T]),q=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,P,!1):t.end("This page could not be found"),null);if(_&&!b){let e=!!$.routes[T],t=$.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await q();throw new R.NoFallbackError}}let j=null;!_||F.isDev||b||(j="/index"===(j=T)?"/":j);let I=!0===F.isDev||!_,M=_&&!I;U&&D&&(0,i.setReferenceManifestsSingleton)({page:x,clientReferenceManifest:D,serverActionsManifest:U,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:U})});let H=e.method||"GET",k=(0,o.getTracer)(),z=k.getActiveScopeSpan(),B={params:E,prerenderManifest:$,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:I,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>F.onRequestError(e,t,a,A)},sharedContext:{buildId:y}},K=new u.NodeNextRequest(e),L=new u.NodeNextResponse(t),G=d.NextRequestAdapter.fromNodeNextRequest(K,(0,d.signalFromNodeResponse)(t));try{let i=async e=>F.handle(G,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=k.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${H} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${x}`)}),s=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var o,l;let u=async({previousCacheEntry:r})=>{try{if(!s&&N&&O&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await i(n);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=B.renderOpts.collectedTags;if(!_)return await (0,h.sendResponse)(K,L,o,B.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(o.headers);u&&(t[m.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,a=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await F.onRequestError(e,t,{routerKind:"App Router",routePath:x,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:N})},A),t}},d=await F.handleResponse({req:e,nextConfig:C,cacheKey:j,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:$,isRoutePPREnabled:!1,isOnDemandRevalidate:N,revalidateOnlyGenerated:O,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:s});if(!_)return null;if((null==d||null==(o=d.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",N?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),b&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,f.fromNodeOutgoingHttpHeaders)(d.value.headers);return s&&_||c.delete(m.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(K,L,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};z?await l(z):await k.withPropagatedContext(e.headers,()=>k.trace(c.BaseServerSpan.handleRequest,{spanName:`${H} ${x}`,kind:o.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await F.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:N})}),_)throw t;return await (0,h.sendResponse)(K,L,new Response(null,{status:500})),null}}e.s(["handler",()=>B,"patchFetch",()=>z,"routeModule",()=>F,"serverHooks",()=>k,"workAsyncStorage",()=>M,"workUnitAsyncStorage",()=>H],64792)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__fe75acf3._.js.map